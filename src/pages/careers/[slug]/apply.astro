---
import Layout from "../../../layouts/BaseLayout.astro";
import { getJobs } from "../../../lib/jobs";

export async function getStaticPaths() {
  const jobs = await getJobs();
  return jobs.map((job) => ({
    params: { slug: job.slug },
  }));
}

const slug = Astro.params?.slug;
if (!slug || typeof slug !== "string") throw new Error("Missing or invalid job slug.");

const jobTitle = decodeURIComponent(slug.replace(/-/g, " "));
---

<Layout title={`Apply for ${jobTitle}`}>
  <section class="py-20 px-6 bg-[#f9f9f9] min-h-screen">
    <div class="max-w-2xl mx-auto">
      <h1 class="text-3xl font-bold mb-6">Apply for {jobTitle}</h1>

      <!-- âœ… FORM sends data via URL to review.astro -->
      <form action={`/careers/${slug}/review`} method="GET" class="space-y-6">
        <input
          name="name"
          type="text"
          placeholder="Full Name"
          required
          class="w-full border px-4 py-2 rounded"
        />
        <input
          name="email"
          type="email"
          placeholder="Email"
          required
          class="w-full border px-4 py-2 rounded"
        />
        <input
          name="phone"
          type="text"
          placeholder="Phone Number"
          required
          class="w-full border px-4 py-2 rounded"
        />
        <textarea
          name="coverLetter"
          placeholder="Cover Letter"
          rows="5"
          required
          class="w-full border px-4 py-2 rounded"
        ></textarea>

        <button
          type="submit"
          class="bg-[#0054a4] text-white py-2 px-6 rounded hover:bg-blue-700"
        >
          Review Application
        </button>
      </form>
    </div>
  </section>
</Layout>
